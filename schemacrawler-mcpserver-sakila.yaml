services:

  sakila:
    image: sakiladb/mysql
    container_name: sakila
    ports:
      - target: 3306
        published: 3306
        protocol: tcp
        mode: host

  schemacrawler-mcpserver:
    image: schemacrawler/schemacrawler-ai:latest
    container_name: schemacrawler-mcpserver
    stdin_open: true
    tty: true
    depends_on:
      - sakila
    environment:
      SERVER_PORT: 9191
      # (put these in your .env file)
      SCHCRWLR_DATABASE_USER: ${SCHCRWLR_DATABASE_USER}
      SCHCRWLR_DATABASE_PASSWORD: ${SCHCRWLR_DATABASE_PASSWORD}
    ports:
      - target: 9191      # The container port
        published: 9292   # The host port
    volumes:
    - type: bind
      source: ./
      target: /home/schcrwlr/share
    entrypoint: [ '/opt/schemacrawler/bin/schemacrawler.sh' ]
    command: >
      --server mysql
      --host sakila
      --database sakila
      --user:env SCHCRWLR_DATABASE_USER
      --password:env SCHCRWLR_DATABASE_PASSWORD
      --routines .*
      --command list
      --transport sse
      --info-level maximum
      --log-level INFO
    # See https://www.schemacrawler.com/database-support.html for connecting to other databases
